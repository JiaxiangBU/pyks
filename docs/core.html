---

title: pyks
keywords: fastai
sidebar: home_sidebar

summary: "Calculate KS statistic for models"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 00_core.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="example-1">example 1<a class="anchor-link" href="#example-1">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;refs/two_class_example.csv&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>路径也支持联想输入</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="nb">print</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="nb">print</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>                y          yhat
count  500.000000  5.000000e+02
mean     0.516000  5.447397e-01
std      0.500244  4.138621e-01
min      0.000000  1.794262e-07
25%      0.000000  7.289481e-02
50%      1.000000  6.569442e-01
75%      1.000000  9.794348e-01
max      1.000000  9.999965e-01
y       500
yhat    500
dtype: int64
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>y=1</code>判断为好人，相应地，<code>yhat</code>普遍会高。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;good&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">y</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;bad&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">data</span><span class="o">.</span><span class="n">y</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;score&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">yhat</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="summary" class="doc_header"><code>summary</code><a href="pyks/ks.py#L6" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>summary</code>(<strong><code>df</code></strong>, <strong><code>n_group</code></strong>=<em><code>10</code></em>)</p>
</blockquote>
<p>Calculation KS statistic
Inspired by one WenSui Liu's blog at 
<a href="https://statcompute.wordpress.com/2012/11/18/calculating-k-s-statistic-with-python/">https://statcompute.wordpress.com/2012/11/18/calculating-k-s-statistic-with-python/</a></p>
<h2 id="Parmaters">Parmaters<a class="anchor-link" href="#Parmaters">&#182;</a></h2><p>df: pandas.DataFrame
    with M x N size.
    M length is the number of bins.
    N measures the number of metrics related to KS.
n_group: float
         The number of cutted groups.</p>
<h2 id="Returns">Returns<a class="anchor-link" href="#Returns">&#182;</a></h2><p>agg2  : The DataFrame return with KS and related metrics.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">summary</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">n_group</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>min_scr</th>
      <th>max_scr</th>
      <th>bads</th>
      <th>goods</th>
      <th>total</th>
      <th>odds</th>
      <th>bad_rate</th>
      <th>ks</th>
      <th>max_ks</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.794262e-07</td>
      <td>0.002773</td>
      <td>50</td>
      <td>0</td>
      <td>50</td>
      <td>0.00</td>
      <td>100.00%</td>
      <td>20.66</td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.810221e-03</td>
      <td>0.036310</td>
      <td>49</td>
      <td>1</td>
      <td>50</td>
      <td>0.02</td>
      <td>98.00%</td>
      <td>40.52</td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>3.670582e-02</td>
      <td>0.122027</td>
      <td>43</td>
      <td>7</td>
      <td>50</td>
      <td>0.16</td>
      <td>86.00%</td>
      <td>55.58</td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.225460e-01</td>
      <td>0.325715</td>
      <td>37</td>
      <td>13</td>
      <td>50</td>
      <td>0.35</td>
      <td>74.00%</td>
      <td>65.83</td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>3.269821e-01</td>
      <td>0.655164</td>
      <td>31</td>
      <td>19</td>
      <td>50</td>
      <td>0.61</td>
      <td>62.00%</td>
      <td>71.27</td>
      <td>&lt;----</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6.587248e-01</td>
      <td>0.853443</td>
      <td>22</td>
      <td>28</td>
      <td>50</td>
      <td>1.27</td>
      <td>44.00%</td>
      <td>69.51</td>
      <td></td>
    </tr>
    <tr>
      <th>6</th>
      <td>8.561391e-01</td>
      <td>0.958957</td>
      <td>7</td>
      <td>43</td>
      <td>50</td>
      <td>6.14</td>
      <td>14.00%</td>
      <td>55.74</td>
      <td></td>
    </tr>
    <tr>
      <th>7</th>
      <td>9.623505e-01</td>
      <td>0.987179</td>
      <td>1</td>
      <td>49</td>
      <td>50</td>
      <td>49.00</td>
      <td>2.00%</td>
      <td>37.16</td>
      <td></td>
    </tr>
    <tr>
      <th>8</th>
      <td>9.875471e-01</td>
      <td>0.997897</td>
      <td>2</td>
      <td>48</td>
      <td>50</td>
      <td>24.00</td>
      <td>4.00%</td>
      <td>19.38</td>
      <td></td>
    </tr>
    <tr>
      <th>9</th>
      <td>9.979229e-01</td>
      <td>0.999997</td>
      <td>0</td>
      <td>50</td>
      <td>50</td>
      <td>inf</td>
      <td>0.00%</td>
      <td>-0.00</td>
      <td></td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="example-2">example 2<a class="anchor-link" href="#example-2">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="k">import</span> <span class="n">roc_curve</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;refs/two_class_example.csv&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>
 

